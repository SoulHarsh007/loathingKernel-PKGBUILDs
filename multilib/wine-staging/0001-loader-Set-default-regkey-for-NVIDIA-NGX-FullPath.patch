From b17f8747c65556b8e8004492b8a6e8af150c1c8b Mon Sep 17 00:00:00 2001
From: Liam Middlebrook <lmiddlebrook@nvidia.com>
Date: Mon, 11 Oct 2021 11:16:49 +0200
Subject: [PATCH] loader: Set default regkey for NVIDIA NGX FullPath

Sets the default location for the NVIDIA NGX SDK search-path to be
C:\Windows\System32\

This is required for supporting NVIDIA DLSS within Proton.

Reviewed-by: Adam Moss <amoss@nvidia.com>
---
 loader/wine.inf.in | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/loader/wine.inf.in b/loader/wine.inf.in
index 9db37f73ffb..dd394f8ac12 100644
--- a/loader/wine.inf.in
+++ b/loader/wine.inf.in
@@ -96,6 +96,7 @@ AddReg=\
     ThemeManager,\
     VersionInfo,\
     LicenseInformation,\
+    NVIDIANGX, \
     ProtonOverrides,\
     SteamClient
 
@@ -123,6 +124,7 @@ AddReg=\
     ThemeManager,\
     VersionInfo,\
     LicenseInformation,\
+    NVIDIANGX, \
     ProtonOverrides,\
     SteamClient.ntamd64
 
@@ -165,6 +167,7 @@ AddReg=\
     Tapi,\
     VersionInfo,\
     LicenseInformation,\
+    NVIDIANGX, \
     ProtonOverrides,\
     SteamClient.ntamd64
 
@@ -2749,6 +2752,9 @@ HKCU,Software\Valve\Steam\ActiveProcess,"SteamClientDll64",,"%16426%\Steam\steam
 HKCU,Software\Valve\Steam\ActiveProcess,"SteamPath",,"%16426%\Steam"
 HKLM,Software\Wow6432Node\Valve\Steam,"InstallPath",,"%16422%\Steam"
 
+[NVIDIANGX]
+HKLM,Software\NVIDIA Corporation\Global\NGXCore,"FullPath",,"C:\Windows\System32"
+
 [ProtonOverrides]
 HKLM,Software\Khronos\OpenXR\1,"ActiveRuntime",,"C:\openxr\wineopenxr64.json"
 ;;Likely want *80 and *90 too, but those require removing Wine's manifest files.
-- 
2.45.2

